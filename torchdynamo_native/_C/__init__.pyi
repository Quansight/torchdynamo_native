from typing import List

import torch


def operation_in_registry(opname: str) -> bool: ...


class Value:
    ...


class Function:
    ...
    def __init__(self, id: str, in_tensors: int, out_tensors: int) -> None: ...

    def set_placeholder(self, i: int, name: str) -> Value: ...
    def set_outputs(self, outputs: List[Value]) -> List[Value]: ...
    def set_output(self, output: Value) -> Value: ...

    def add_call(self, symbolname: str, opname: str, args: List[Value]) -> Value: ...

    def dump(self) -> None: ...

    def build_bool(self, b: bool) -> Value: ...
    def build_load(self, val: Value) -> Value: ...

    def build_int(self, i: int) -> Value: ...
    def build_float(self, f: float) -> Value: ...
    def build_str(self, s: str) -> Value: ...

    def build_int_from_scalar_type(self, scalar_type: torch.dtype) -> Value: ...
    def build_int_from_memory_format(self, memory_format: torch.memory_format) -> Value: ...

    def build_scalar_int(self, literal: Value) -> Value: ...
    def build_scalar_float(self, literal: Value) -> Value: ...

    def build_array_int(self, elements: List[Value]) -> Value: ...
    def build_array_tensor(self, elements: List[Value]) -> Value: ...

    def build_list_optional_tensor(self, elements: List[Value]) -> Value: ...

    def build_nullopt_bool(self) -> Value: ...
    def build_nullopt_int(self) -> Value: ...
    def build_nullopt_float(self) -> Value: ...
    def build_nullopt_str(self) -> Value: ...
    def build_nullopt_scalar_type(self) -> Value: ...
    def build_nullopt_memory_format(self) -> Value: ...
    def build_nullopt_layout(self) -> Value: ...
    def build_nullopt_device(self) -> Value: ...
    def build_nullopt_generator(self) -> Value: ...
    def build_nullopt_tensor(self) -> Value: ...

    def build_optional_int(self, i: Value) -> Value: ...
    def build_optional_float(self, f: Value) -> Value: ...
    def build_optional_scalar_type(self, scalar_type: Value) -> Value: ...
    def build_optional_memory_format(self, memory_format: Value) -> Value: ...
    def build_optional_scalar_int(self, i: Value) -> Value: ...
    def build_optional_scalar_float(self, f: Value) -> Value: ...
    def build_optional_arrayref_int(self, ptr: Value, size: Value) -> Value: ...
    def build_optional_str(self, ptr: Value, size: Value) -> Value: ...

    def build_optional_from_ref_tensor(self, tensor: Value) -> Value: ...

    def build_optionalarrayref_int(self, elements: List[Value]) -> Value: ...
    def build_nullopt_optionalarrayref_int(self) -> Value: ...

    def build_vector_index(self, vector: Value, position: Value) -> Value: ...

    def into_jit(self) -> "JITFunction": ...


class JITFunction:
    ...
    def run(self, in_tensors: List[torch.Tensor]) -> List[torch.Tensor]: ...

    def __call__(self, in_tensors: List[torch.Tensor]) -> List[torch.Tensor]: ...
